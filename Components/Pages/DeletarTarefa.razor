@page "/tarefas/excluir/{id:int}"

@rendermode InteractiveServer
@inject ApplicationDbContext Context
@inject NavigationManager Navigation


<h3 style="font-family: 'Courier New', Courier, monospace;"><b>Editar tarefa</b></h3>

@if (Tarefa != null)
{
    <EditForm Model="@Tarefa" OnValidSubmit="ExcluirTarefa" FormName="excluirTarefa">

        <DataAnnotationsValidator />
        <ValidationSummary />

        <div class="form-group">
            <label for="TarefaName">Nome Tarefa:</label>
            <input type="text" class="form-control" id="TarefaName" @bind="Tarefa.TarefaName" readonly />
        </div>
        <div class="form-group">
            <label for="TarefaDescription">Descrição:</label>
            <textarea class="form-control" id="TarefaDescription" @bind="Tarefa.TarefaDescription" readonly></textarea>
        </div>
        <div class="form-group">
            <label for="DataTarefa">Data:</label>
            <input type="date" class="form-control" id="DataTarefa" @bind="Tarefa.DataTarefa" readonly />
        </div>
        <div class="form-group">
            <label for="StatusTarefa">Status da Tarefa:</label>
            <input type="text" class="form-control" id="StatusTarefa" @bind="Tarefa.StatusTarefa" readonly />
        </div>

        <button type="submit" class="btn btn-danger mt-2">Excluir tarefa</button>

    </EditForm>
}
else
{
    <p>Tarefa não encontrada.</p>
}

@code {

    [Parameter]
    public int Id { get; set; }

    public Todo Tarefa { get; set; }

    protected override async Task OnInitializedAsync()
    {
        Tarefa = await Context.Todos.FindAsync(Id);
    }

    public async Task ExcluirTarefa()
    {
        Context.Todos.Remove(Tarefa);
        await Context.SaveChangesAsync();
        Navigation.NavigateTo(uri: "tarefas");
    }
}